<!doctype html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Доски</title>
    <link rel="stylesheet" th:href="@{/css/pico.classless.blue.min.css}">
    <style>
        body { padding: 0.6rem; }
        header { display:flex; align-items:center; gap:.6rem; }
        .boards-list { display:flex; flex-direction:column; gap:0.9rem; margin-top:1rem; }
        .board-link { display:block; text-decoration:none; color:inherit; }
        .board-card {
            padding:1rem; border-radius:12px;
            background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
            box-shadow: 0 4px 12px rgba(0,0,0,0.04);
            display:flex; justify-content:space-between; align-items:center;
        }
        .board-title { font-size:1.05rem; font-weight:700; margin:0; color:var(--contrast);
            white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:calc(100% - 80px);
        }
        .board-meta { font-size:0.85rem; color:var(--muted); margin-left:0.6rem; }
        .empty { text-align:center; padding:2rem 1rem; color:var(--muted); }
        .create-form { margin-top: 0.9rem; display:flex; flex-direction:column; gap:0.5rem; }
        .create-form input[type="text"]{ width:100%; padding:0.8rem; border-radius:10px; border:1px solid rgba(0,0,0,0.06); background:var(--surface-0); }
        .create-form button{ width:100%; padding:0.7rem; border-radius:10px; }
        .visually-hidden{
            position:absolute!important; width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;
        }
        @media (min-width:640px) {
            .boards-list { display:grid; grid-template-columns:1fr 1fr; gap:0.9rem; }
            .create-form { flex-direction:row; align-items:center; }
            .create-form input[type="text"]{ flex:1; width:auto; }
            .create-form button{ width:auto; padding:0.6rem 1rem; }
            .board-card{ padding:1rem; }
        }
    </style>
</head>
<body>
<header>
    <h1 style="margin:0; font-size:1.15rem;">Доски</h1>
</header>
<main class="container">
    <section>
        <form class="create-form" th:action="@{/cardboards}" th:object="${cardboard}" method="post">
            <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <label for="title" class="visually-hidden">Название доски</label>
            <input id="title" type="text" th:field="*{title}" placeholder="Название новой доски" required />
            <button type="submit">Создать</button>
        </form>

        <div th:if="${cardboards == null or #lists.isEmpty(cardboards)}" class="empty">
            Нет досок.
        </div>

        <div class="boards-list" th:if="${cardboards != null and !#lists.isEmpty(cardboards)}">
            <div th:each="board : ${cardboards}" style="display:flex;">
                <a th:href="@{/cardboard/{id}(id=${board.uuid})}"
                   class="board-link" style="flex:1;">
                    <article class="board-card">
                        <div style="display:flex; align-items:center; gap:0.6rem; width:100%;">
                            <h2 class="board-title" th:text="${board.title}">Название доски</h2>
                            <div class="board-meta" th:text="${board.cards != null ? board.cards.size() + ' карточек' : '0 карточек'}">0 карточек</div>
                        </div>
                    </article>
                </a>
                <form th:action="@{/cardboards/{id}/delete(id=${board.uuid})}" method="post" style="margin-left:8px;">
                    <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <button type="submit" title="Удалить доску" style="background:transparent; border:none; color:#c0392b; padding:8px; border-radius:8px;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <path d="M3 6h18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M8 6v12a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M10 11v6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M14 11v6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </form>
            </div>
        </div>
    </section>
</main>

<footer style="padding:0.8rem 0; text-align:center; font-size:0.85rem; color:var(--muted);">
    <small th:if="${user != null}" th:text="'Пользователь: ' + ${user.user_id}">Пользователь</small>
</footer>

</body>
</html>
